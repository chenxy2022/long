# 给龙Q：图片爬虫代码
> 采用异步方式 aiohttp,aiofiles   
> 爬取的网址:http://www.defuv.com/
> 爬取公开区图案和素材区的图片略缩图。
## 爬取步骤：  
1. 通过网页查看ajax，获取网址和参数信息 
2. 获取网页的json信息,(难点：json无法解析，采用参数content_type='text/html')
3. 根据json信息，通过pandas转化为df，生成文件名和网址。
4. df信息进行下载图片
5. 默认10页为一组，按组生成tasks，同时运行。每组内3大步骤（步骤内异步）串行（下载页面上图片网址，下载图片内容，写入文件）。  
6. 将组任务变为协程，即几个组同时异步，效率是提高了，设置并发数35，防止被服务器踢掉。
## 文件说明  
1. defuv.py  
   > 爬取文件
## 更新说明
1. 由于公开区和素材区仅仅是参数 type不同，因此合并为一个文件，defuv.py，同时增加了进度条。其他文件删除。
2. 修复，网页图片异常导致整个程序停掉的bug：忽略错误：asyncio.TimeoutError, ClientPayloadError
3. 异步版本增加了tcp连接的限制，防止爬取过快被服务器踢掉。文件名：defuv_open全异步TCP控制.py，删除了会被服务器踢掉的版本。


